SELECT t.title AS "Title", CONCAT(t.description, ', ', t.creation_date) AS "Description and Creation Date"
FROM task AS t;

SELECT * FROM task;

SELECT t.title, t.description, t.results, s.status, p.priority, t.creation_date
FROM task AS t 
JOIN priority AS p
ON t.priority = p.priority_id
JOIN status AS s
ON t.status = s.status_id;

SELECT tasktag.task_id, STRING_AGG(tag.name, ', ') AS "task tags"
FROM tag
JOIN tasktag ON tag.tag_id = tasktag.tag_id
GROUP BY tasktag.task_id;

SELECT tasktag.task_id, task.title, STRING_AGG(tag.name, ', ') AS "task tags"
FROM tag
JOIN tasktag ON tag.tag_id = tasktag.tag_id
JOIN task ON task.task_id = tasktag.task_id
GROUP BY task.title, tasktag.task_id;

SELECT 
	task.title,
	task.description,
	task.results,
	priority.priority,
	status.status,
	task.creation_date,
	STRING_AGG(tag.name, ', ') AS "task tags"
FROM tag
JOIN tasktag ON tag.tag_id = tasktag.tag_id
JOIN task ON task.task_id = tasktag.task_id
JOIN priority ON task.priority = priority.priority_id
JOIN status ON task.status = status.status_id
GROUP BY 
	task.title,
	task.description,
	task.results,
	priority.priority,
	status.status,
	task.creation_date;
	
SELECT 
    task.title,
    task.description,
    task.results,
    priority.priority,
    status.status,
    task.creation_date,
    (
        SELECT STRING_AGG(CONCAT('#', tag.name), ' ') 
        FROM tag
        JOIN tasktag ON tag.tag_id = tasktag.tag_id
        WHERE tasktag.task_id = task.task_id
    ) AS "task tags"
FROM task
JOIN priority ON task.priority = priority.priority_id
JOIN status ON task.status = status.status_id;

SELECT 
	task.*,
    priority.priority AS "priority_value",
    status.status AS "status_value",
    (
        SELECT STRING_AGG(CONCAT('#', tag.name), ' ') 
        FROM tag
        JOIN tasktag ON tag.tag_id = tasktag.tag_id
        WHERE tasktag.task_id = task.task_id
    ) AS "task tags"
FROM task
JOIN priority ON task.priority = priority.priority_id
JOIN status ON task.status = status.status_id;

SELECT tag.tag_id, tag.name,
	CASE 
		WHEN tag.tag_id IN 
		(
			SELECT tasktag.tag_id
			from tag
			JOIN tasktag ON tag.tag_id = tasktag.tag_id
			WHERE tasktag.task_id = 3
		)
		THEN true
		ELSE false
	END AS "relative"
FROM tag;

SELECT employee.employee_id, employee.name,
	CASE 
		WHEN employee.employee_id IN 
		(
			SELECT members.employee
			from employee
			JOIN members ON employee.employee_id = members.employee
			WHERE members.employee_group = 3
		)
		THEN true
		ELSE false
	END AS "checked"
FROM employee;

SELECT t.task_id, t.title, tag.*
FROM task AS t
JOIN tasktag AS tt ON t.task_id = tt.task_id
JOIN tag ON tt.tag_id = tag.tag_id
WHERE LOWER(t.title) LIKE 'task%' AND tag.name IN ('tag1', 'nt1');

SELECT DISTINCT 
    t.*,
    p.priority AS "priority_value",
    s.status AS "status_value",
    (
        SELECT STRING_AGG(CONCAT('#', tag.name), ' ') 
        FROM tag
        JOIN tasktag ON tag.tag_id = tasktag.tag_id
        WHERE tasktag.task_id = t.task_id
    ) AS "task tags"
FROM 
    task t
JOIN 
    priority p ON t.priority = p.priority_id
JOIN 
    status s ON t.status = s.status_id
JOIN 
    tasktag tt ON t.task_id = tt.task_id
JOIN 
    tag ON tt.tag_id = tag.tag_id
WHERE 
    LOWER(t.title) LIKE '%' AND tag.name IN ('nt1', 'tag1', 'tag2', 'Home', 'nt1');